---
import Layout from '../../../layouts/Layout.astro';
import Header from '../../../layouts/Header.astro';
import Footer from '../../../layouts/Footer.astro';
import BlogSection from '../../../components/blog/BlogSection.astro';
import { getCollection } from 'astro:content';
import { getLangFromUrl, useTranslations } from '../../../services/i18n';

export const prerender = true;

export function getStaticPaths() {
  return [
    { params: { locale: 'en' } },
    { params: { locale: 'es' } },
    { params: { locale: 'ja' } }
  ];
}

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

const allPosts = await getCollection('blog');
const posts = allPosts
  .filter(post => !post.data.draft && post.id.startsWith(`${lang}/`))
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());
---

<Layout title={`${t('nav.blog')} - Airán`} description="Blog posts about web development" lang={lang}>
  <Header />
  
  <main class="min-h-screen bg-gradient-to-br from-alabaster via-alabaster-100 to-alabaster-200 dark:from-carbon dark:via-carbon-800 dark:to-carbon-900 py-16">
    <div class="container mx-auto px-4 max-w-7xl">
      <!-- Header Section -->
      <div class="text-center mb-16">
        <h1 class="text-5xl md:text-6xl font-bold mb-4 text-stormy dark:text-seaweed">
          {t('nav.blog')}
        </h1>
        <p class="text-lg text-carbon/70 dark:text-alabaster/70 max-w-2xl mx-auto">
          {lang === 'es' 
            ? 'Artículos sobre desarrollo web, programación y tecnología' 
            : lang === 'ja'
            ? 'ウェブ開発、プログラミング、テクノロジーに関する記事'
            : 'Articles about web development, programming, and technology'
          }
        </p>
      </div>
      
      <!-- Blog Section with Filters and Grid -->
      <BlogSection posts={posts} locale={lang} />
    </div>
  </main>

  <Footer />
</Layout>
