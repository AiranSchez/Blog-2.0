@tailwind base;
@tailwind components;
@tailwind utilities;

/* CSS Custom Properties for Design System */
:root {
  /* Colors */
  --color-carbon: #1f2421;
  --color-stormy: #216869;
  --color-seaweed: #49a078;
  --color-muted: #9cc5a1;
  --color-alabaster: #dce1de;
  
  /* Spacing scale */
  --spacing-xs: 0.5rem;
  --spacing-sm: 0.75rem;
  --spacing-md: 1rem;
  --spacing-lg: 1.5rem;
  --spacing-xl: 2rem;
  --spacing-2xl: 3rem;
  --spacing-3xl: 4rem;
  
  /* Typography */
  --font-sans: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  
  /* Fluid Typography Scale with clamp() */
  --text-xs: clamp(0.75rem, 0.7rem + 0.2vw, 0.875rem);
  --text-sm: clamp(0.875rem, 0.8rem + 0.3vw, 1rem);
  --text-base: clamp(1rem, 0.95rem + 0.25vw, 1.125rem);
  --text-lg: clamp(1.125rem, 1.05rem + 0.35vw, 1.25rem);
  --text-xl: clamp(1.25rem, 1.15rem + 0.45vw, 1.5rem);
  --text-2xl: clamp(1.5rem, 1.35rem + 0.65vw, 1.875rem);
  --text-3xl: clamp(1.875rem, 1.65rem + 1vw, 2.25rem);
  --text-4xl: clamp(2.25rem, 1.95rem + 1.35vw, 3rem);
  --text-5xl: clamp(3rem, 2.5rem + 2vw, 3.75rem);
  --text-6xl: clamp(3.75rem, 3rem + 3vw, 4.5rem);
  --text-7xl: clamp(4.5rem, 3.5rem + 4vw, 6rem);
  
  /* Line Heights */
  --leading-tight: 1.25;
  --leading-snug: 1.375;
  --leading-normal: 1.5;
  --leading-relaxed: 1.625;
  --leading-loose: 2;
  
  /* Transitions */
  --duration-fast: 150ms;
  --duration-normal: 300ms;
  --duration-slow: 500ms;
  
  /* Border radius */
  --radius-sm: 0.25rem;
  --radius-md: 0.375rem;
  --radius-lg: 0.5rem;
  --radius-xl: 0.75rem;
  
  /* Z-index scale */
  --z-dropdown: 1000;
  --z-sticky: 1020;
  --z-fixed: 1030;
  --z-modal-backdrop: 1040;
  --z-modal: 1050;
  --z-popover: 1060;
  --z-tooltip: 1070;
}

/* Base styles */
@layer base {
  html {
    scroll-behavior: smooth;
    scroll-padding-top: 5rem;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }
  
  body {
    @apply text-carbon dark:text-alabaster;
    @apply bg-alabaster dark:bg-carbon;
    @apply transition-colors duration-300;
  }
  
  /* Typography improvements */
  h1, h2, h3, h4, h5, h6 {
    text-wrap: balance;
    @apply font-semibold;
  }
  
  p {
    text-wrap: pretty;
  }
  
  /* Focus states for accessibility */
  :focus-visible {
    @apply outline-none ring-2 ring-stormy ring-offset-2;
  }
  
  /* Skip to main content link */
  .skip-to-main {
    @apply absolute left-0 -top-full;
    @apply focus:top-0;
    @apply px-4 py-2 bg-stormy text-white;
    @apply z-[9999] transition-all;
  }
  
  /* Improve tap targets on mobile */
  button, a {
    touch-action: manipulation;
    -webkit-tap-highlight-color: transparent;
  }
  
  /* Better text selection */
  ::selection {
    @apply bg-stormy/20 text-carbon;
  }
  
  ::-moz-selection {
    @apply bg-stormy/20 text-carbon;
  }
  
  /* Tabular numbers for data */
  .tabular-nums {
    font-variant-numeric: tabular-nums;
  }
  
  /* Proper ellipsis character */
  .loading-text::after {
    content: 'â€¦';
  }
}

/* Component utilities */
@layer components {
  /* Fluid Typography Utilities */
  .text-fluid-xs { font-size: var(--text-xs); }
  .text-fluid-sm { font-size: var(--text-sm); }
  .text-fluid-base { font-size: var(--text-base); }
  .text-fluid-lg { font-size: var(--text-lg); }
  .text-fluid-xl { font-size: var(--text-xl); }
  .text-fluid-2xl { font-size: var(--text-2xl); }
  .text-fluid-3xl { font-size: var(--text-3xl); }
  .text-fluid-4xl { font-size: var(--text-4xl); }
  .text-fluid-5xl { font-size: var(--text-5xl); }
  .text-fluid-6xl { font-size: var(--text-6xl); }
  .text-fluid-7xl { font-size: var(--text-7xl); }
  
  /* Heading styles with consistent spacing and line-height */
  .heading-hero {
    font-size: var(--text-6xl);
    line-height: var(--leading-tight);
    @apply font-bold tracking-tight;
  }
  
  .heading-1 {
    font-size: var(--text-5xl);
    line-height: var(--leading-tight);
    @apply font-bold tracking-tight;
  }
  
  .heading-2 {
    font-size: var(--text-4xl);
    line-height: var(--leading-snug);
    @apply font-bold tracking-tight;
  }
  
  .heading-3 {
    font-size: var(--text-2xl);
    line-height: var(--leading-snug);
    @apply font-semibold;
  }
  
  .heading-4 {
    font-size: var(--text-xl);
    line-height: var(--leading-normal);
    @apply font-semibold;
  }
  
  .body-lg {
    font-size: var(--text-lg);
    line-height: var(--leading-relaxed);
  }
  
  .body-base {
    font-size: var(--text-base);
    line-height: var(--leading-normal);
  }
  
  .body-sm {
    font-size: var(--text-sm);
    line-height: var(--leading-normal);
  }

  /* Container with consistent padding */
  .container-custom {
    @apply container mx-auto px-4 md:px-6 lg:px-8;
  }
  
  /* Card base styles */
  .card-base {
    @apply bg-white dark:bg-carbon-700;
    @apply rounded-lg shadow-md;
    @apply border border-alabaster-200 dark:border-carbon-600;
    @apply transition-all duration-300;
  }
  
  /* Button base styles */
  .btn-base {
    @apply inline-flex items-center justify-center;
    @apply px-4 py-2 rounded-lg;
    @apply font-medium text-sm;
    @apply transition-all duration-300;
    @apply focus-visible:ring-2 focus-visible:ring-offset-2;
    @apply disabled:opacity-50 disabled:cursor-not-allowed;
  }
  
  /* Link styles with proper underline */
  .link-base {
    @apply underline decoration-stormy/30;
    @apply hover:decoration-stormy;
    @apply transition-colors duration-200;
  }
  
  /* Prose improvements for blog content */
  .prose-custom {
    @apply prose prose-lg;
    @apply dark:prose-invert;
    @apply max-w-none;
    
    /* Better typography scale */
    font-size: var(--text-base);
    line-height: var(--leading-relaxed);
    
    /* Headings with fluid typography */
    & h1 { 
      font-size: var(--text-4xl); 
      line-height: var(--leading-tight);
      margin-top: 2em;
      margin-bottom: 0.75em;
    }
    & h2 { 
      font-size: var(--text-3xl); 
      line-height: var(--leading-tight);
      margin-top: 1.75em;
      margin-bottom: 0.65em;
    }
    & h3 { 
      font-size: var(--text-2xl); 
      line-height: var(--leading-snug);
      margin-top: 1.5em;
      margin-bottom: 0.6em;
    }
    & h4 { 
      font-size: var(--text-xl); 
      line-height: var(--leading-normal);
      margin-top: 1.5em;
      margin-bottom: 0.5em;
    }
    
    /* Paragraph spacing */
    & p {
      margin-bottom: 1.25em;
      text-wrap: pretty;
    }
    
    /* List improvements */
    & ul, & ol {
      margin-bottom: 1.25em;
      & li {
        margin-bottom: 0.5em;
        line-height: var(--leading-relaxed);
      }
    }
    
    /* Code blocks */
    & pre {
      @apply rounded-lg;
      @apply bg-carbon-900 dark:bg-carbon-800;
      padding: 1.25rem;
      overflow-x: auto;
      margin-bottom: 1.5em;
    }
    
    & code {
      @apply px-1.5 py-0.5 rounded;
      @apply bg-muted/10 dark:bg-carbon-800;
      font-size: 0.875em;
    }
    
    /* Links */ 
    & a {
      @apply text-stormy dark:text-seaweed;
      @apply no-underline hover:underline;
      @apply decoration-2 underline-offset-2;
      @apply transition-colors;
    }
    
    /* Blockquotes */
    & blockquote {
      @apply border-l-4 border-stormy dark:border-seaweed;
      @apply pl-4 italic;
      @apply text-carbon/80 dark:text-alabaster/80;
      margin: 1.5em 0;
    }
    
    /* Tables */
    & table {
      @apply w-full border-collapse;
      margin: 1.5em 0;
      
      & th {
        @apply bg-muted/10 dark:bg-carbon-800;
        @apply font-semibold text-left;
        padding: 0.75rem;
      }
      
      & td {
        padding: 0.75rem;
        @apply border-t border-muted/20 dark:border-carbon-700;
      }
    }
    
    /* Images */
    & img {
      @apply rounded-lg;
      margin: 1.5em 0;
    }
  }
}

/* Utility classes */
@layer utilities {
  /* Text truncation utilities */
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
  
  .line-clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
  
  /* Prevent layout shift during loading */
  .prevent-cls {
    content-visibility: auto;
  }
  
  /* Safe area insets for mobile */
  .safe-area-inset {
    padding-left: env(safe-area-inset-left);
    padding-right: env(safe-area-inset-right);
  }
  
  .safe-area-inset-top {
    padding-top: env(safe-area-inset-top);
  }
  
  .safe-area-inset-bottom {
    padding-bottom: env(safe-area-inset-bottom);
  }
}

/* Reduced motion preferences */
@media (prefers-reduced-motion: reduce) {
  html {
    scroll-behavior: auto;
  }
  
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}

/* Dark mode specific adjustments */
@media (prefers-color-scheme: dark) {
  html:not(.light) {
    color-scheme: dark;
  }
}

html.dark {
  color-scheme: dark;
}

/* Print styles */
@media print {
  * {
    background: transparent !important;
    color: black !important;
    box-shadow: none !important;
    text-shadow: none !important;
  }
  
  a {
    text-decoration: underline;
  }
  
  pre, blockquote {
    border: 1px solid #999;
    page-break-inside: avoid;
  }
  
  thead {
    display: table-header-group;
  }
  
  tr, img {
    page-break-inside: avoid;
  }
  
  img {
    max-width: 100% !important;
  }
  
  p, h2, h3 {
    orphans: 3;
    widows: 3;
  }
  
  h2, h3 {
    page-break-after: avoid;
  }
}
